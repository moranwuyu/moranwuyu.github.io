<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
  
  <entry>
    <title>国内私营企业的终点是哪里？</title>
    <link href="/2025/08/18/%E5%9B%BD%E5%86%85%E7%A7%81%E8%90%A5%E4%BC%81%E4%B8%9A%E7%9A%84%E7%BB%88%E7%82%B9%E6%98%AF%E5%93%AA%E9%87%8C%EF%BC%9F/"/>
    <url>/2025/08/18/%E5%9B%BD%E5%86%85%E7%A7%81%E8%90%A5%E4%BC%81%E4%B8%9A%E7%9A%84%E7%BB%88%E7%82%B9%E6%98%AF%E5%93%AA%E9%87%8C%EF%BC%9F/</url>
    
    <content type="html"><![CDATA[<p>邓公曾说过“先富带动后富”<sup>[1]</sup><sup>[2]</sup>，是否有对人性的考量？“后富”的人也富了必然会削弱“先富”人的优越感，“先富”的人是否还愿意带动其他人“后富”，“先富”的道德水平是否达到那样的高度…</p><p>现实却是这样的，先富得到国家和社会的认可，确实增加了部分聪明人的创富动力，几十年过去了，他们率先富裕了起来，但是他们大部分人并没有带动后富的丝毫意愿，没有法律的制约亦没有道德的束缚，他们千方百计将先富从国内获得的财富转移到境外，想方设法获得国外居民的身份，他们只想让自己的后代不劳而获却享永世富贵。</p><p>私营企业的终点在哪里与私营企业老板息息相关，私企老板“先富”后的选择，决定了私企的最终命运。可以肯定的是在这种情况下出现百年企业的可能性微乎其微，私企只会成为一位又一位想要“先富”私企老板的圈钱工具击鼓传花下去，直到其国有化或破产清算。所以请慎重为私企打工，终其一生很大可能只会成为其国外子孙世代荣华富贵的工具而已。</p><h3 id="参考文献"><a href="#参考文献" class="headerlink" title="参考文献"></a>参考文献</h3><section class="footnotes"><div class="footnote-list"><ol><li><span id="fn:1" class="footnote-text"><span><strong>首次提出（1978年）</strong>： “要允许一部分地区、一部分企业、一部分工人农民，由于辛勤努力成绩大而收入先多一些，生活先好起来。一部分人生活先好起来，就必然产生极大的示范力量，影响左邻右舍，带动其他地区、其他单位的人们向他们学习。”（《解放思想，实事求是，团结一致向前看》）。<a href="#fnref:1" rev="footnote" class="footnote-backref"> ↩</a></span></span></li><li><span id="fn:2" class="footnote-text"><span><strong>战略定位（1985年）</strong>： “我们的政策是让一部分人、一部分地区先富起来，以带动和帮助落后的地区…就全国范围来说，我们一定能够逐步顺利解决沿海同内地贫富差距的问题。”（会见美国企业家代表团时讲话）<a href="#fnref:2" rev="footnote" class="footnote-backref"> ↩</a></span></span></li></ol></div></section>]]></content>
    
    
    <categories>
      
      <category>经济</category>
      
      <category>其他</category>
      
    </categories>
    
    
    <tags>
      
      <tag>原创</tag>
      
      <tag>悟</tag>
      
      <tag>随想</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>授信不足的情况授信应用于开证还是TT押汇</title>
    <link href="/2023/12/12/%E6%8E%88%E4%BF%A1%E4%B8%8D%E8%B6%B3%E7%9A%84%E6%83%85%E5%86%B5%E6%8E%88%E4%BF%A1%E5%BA%94%E7%94%A8%E4%BA%8E%E5%BC%80%E8%AF%81%E8%BF%98%E6%98%AFTT%E6%8A%BC%E6%B1%87/"/>
    <url>/2023/12/12/%E6%8E%88%E4%BF%A1%E4%B8%8D%E8%B6%B3%E7%9A%84%E6%83%85%E5%86%B5%E6%8E%88%E4%BF%A1%E5%BA%94%E7%94%A8%E4%BA%8E%E5%BC%80%E8%AF%81%E8%BF%98%E6%98%AFTT%E6%8A%BC%E6%B1%87/</url>
    
    <content type="html"><![CDATA[<table><thead><tr><th>序号</th><th>结清</th><th>业务类型</th><th>放款日</th><th>到期日</th><th>放款币种</th><th>业务金额</th><th>敞口占用</th><th>利率</th><th>综合费率</th></tr></thead><tbody><tr><td>1</td><td>是</td><td>信用证</td><td>2023&#x2F;8&#x2F;7</td><td>2023&#x2F;8&#x2F;30</td><td>USD</td><td>2,713.64</td><td>-</td><td></td><td></td></tr><tr><td>1</td><td>否</td><td>进口押汇</td><td>2023&#x2F;8&#x2F;30</td><td>2024&#x2F;1&#x2F;31</td><td>CNY</td><td>15,430.14</td><td>15,430.14</td><td>3.950%</td><td>4.785%</td></tr><tr><td>2</td><td>是</td><td>信用证</td><td>2023&#x2F;7&#x2F;28</td><td>2023&#x2F;8&#x2F;31</td><td>USD</td><td>2,634.31</td><td>-</td><td></td><td></td></tr><tr><td>2</td><td>否</td><td>进口押汇</td><td>2023&#x2F;8&#x2F;31</td><td>2024&#x2F;1&#x2F;24</td><td>CNY</td><td>13,768.56</td><td>13,768.56</td><td>3.580%</td><td>4.785%</td></tr><tr><td>3</td><td>是</td><td>信用证</td><td>2023&#x2F;9&#x2F;8</td><td>2023&#x2F;10&#x2F;20</td><td>CNY</td><td>19,330.86</td><td>-</td><td></td><td></td></tr><tr><td>3</td><td>否</td><td>进口押汇</td><td>2023&#x2F;10&#x2F;20</td><td>2024&#x2F;3&#x2F;6</td><td>CNY</td><td>12,338.13</td><td>12,338.13</td><td>3.355%</td><td>4.785%</td></tr><tr><td>4</td><td>是</td><td>信用证</td><td>2023&#x2F;8&#x2F;8</td><td>2023&#x2F;10&#x2F;9</td><td>CNY</td><td>20,600.71</td><td>-</td><td></td><td></td></tr><tr><td>4</td><td>否</td><td>进口押汇</td><td>2023&#x2F;10&#x2F;9</td><td>2024&#x2F;3&#x2F;15</td><td>CNY</td><td>13,000.00</td><td>13,000.00</td><td>3.530%</td><td>4.785%</td></tr><tr><td>5</td><td>否</td><td>信用证</td><td>2023&#x2F;11&#x2F;9</td><td></td><td>CNY</td><td>19,972.61</td><td>15,978.09</td><td></td><td></td></tr><tr><td>6</td><td>否</td><td>信用证</td><td>2023&#x2F;11&#x2F;29</td><td></td><td>CNY</td><td>33,346.22</td><td>26,676.97</td><td></td><td></td></tr><tr><td>7</td><td>否</td><td>进口押汇-TT</td><td>2023&#x2F;12&#x2F;1</td><td>2024&#x2F;5&#x2F;29</td><td>CNY</td><td>33,088.17</td><td>33,088.17</td><td>4.785%</td><td>4.785%</td></tr><tr><td>合计</td><td></td><td></td><td></td><td></td><td>130,280.06</td><td></td><td></td><td></td><td></td></tr></tbody></table><p>2023年12月8日企业某银行授信敞口可用余额4,441.04万元，已占用130,280.06万元,无可用余额,明细如上表所示：</p><p>(1)信用证结清当日办理进口押汇,信用证不再占用敞口</p><p>(2)TT项下进口押汇(序号7)的,期限不超180天,贷款费率为4.785%,无保证金,也无其他费用.</p><p>(3)信用证加进口押汇期限不超过180天,开证费加押汇利息综合费率年化也为4.785%</p><p>问题:2023年12月18日,企业计划新开信用证金额合计43,840.00万元,因无可用额度,需要提前还款。如何制定还款方案？</p><p>其他关键影响因素:开证费由0.0945%变更为0.35%,但综合成本的年化利率仍等于4.785%,即将多出的开证费由降低押汇利率进行抵消,即如果不发生提前还款则企业不会产生额外损失，不考虑前置利息的时间成本。</p><p>方案一:全额偿还序号1-3证下进口押汇，合计39,598.70万元，加上余额，可用余额44,039.74万元</p><p>方案二:全额偿还序号7 TT项下进口押汇，部分偿还序号2证下押汇10,951.57,合计39,598.70万元，加上余额，可用余额44,039.74万元</p><p>方案一:全额偿还序号1-3证下进口押汇，合计39,598.70万元，加上余额，可用余额44,039.74万元</p><p>开证费为0.35%(实际情况),三笔业务财务费用,</p><p>(1)到期还款: </p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs copy">2,713.64*7.2*0.35%+15,430.14*3.950%*154/360= 329.11<br>2,634.31 *7.2*0.35%+13,768.56 *3.580%*146/360= 266.29<br>19,330.86 *0.35%+ 12,338.13 *3.355%*138/360= 226.34<br>合计: 329.11+266.29+226.34= 821.74<br></code></pre></td></tr></table></figure><p> (2) 12月17日提前还款</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs copy">2,713.64*7.2*0.35%+15,430.14*3.950%*109/360= 252.92<br>2,634.31 *7.2*0.35%+13,768.56 *3.580%*108/360= 214.26 <br>19,330.86 *0.35%+ 12,338.13 *3.355%*58/360= 134.35<br>合计: 252.92+214.26+134.35= 601.53<br></code></pre></td></tr></table></figure><p>如果开证费仍为0.0945%(假设) ,3笔业务财务费用,</p><p>(1)到期还款,因综合成本相同均为4.785%,可倒算出融资利率</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs copy">2,713.64*7.2*0.0945%+15,430.14*4.706%*154/360=329.11<br>2,634.31*7.2*0.0945%+13,768.56 *4.448%*146/360= 266.29<br>19,330.86*0.0945%+ 12,338.13 *4.399%*138/360= 226.34<br>合计: 329.11+266.29+226.34= 821.74,于(1)中财务费用相同<br></code></pre></td></tr></table></figure><p>(2)如果12月17日提前还款,开证费为0.0945%,3笔业务的费用</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs copy">2,713.64*7.2*0.0945%+15,430.14*4.706%*109/360= 238.32<br>2,634.31*7.2*0.0945%+13,768.56 *4.448%*108/360= 201.65<br>19,330.86*0.0945%+ 12,338.13 *4.399%*58/360= 105.71<br>合计: 238.32+201.65+105.71= 545.69<br></code></pre></td></tr></table></figure><p>因开证费由0.0945%变更为0.35%,12月17日提前还款导致多支出财务费用601.53-545.69&#x3D; 55.85万元</p><p>方案二:全额偿还序号7 TT项下进口押汇，部分偿还序号2证下押汇10,951.57,合计39,598.70万元，加上余额，可用余额44,039.74万元</p><p>显然提前日期越多损失越多,所以选择序号,提前的日期最少为38天.</p><p>开证费为0.35%(实际情况),2笔业务财务费用,</p><p>(1)到期还款: </p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs copy">33,088.17*4.785%*180/360= 791.63<br>2,634.31 *7.2*0.35%+13,768.56 *3.580%*146/360= 266.29<br>合计: 791.63+266.294= 1,057.92<br><br></code></pre></td></tr></table></figure><p>(2) 12月17日提前部分还款:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs copy">33,088.17*4.785%*16/360= 70.37<br>2,634.31*7.2*0.35%+10,951.57*3.580%*108/360+(13,768.56-10,951.57)*3.580%*146/360=  224.90  合计: 70.37+224.90= 295.27<br></code></pre></td></tr></table></figure><p>如果开证费仍为0.0945%(假设) ,三笔业务财务费用,</p><p>(1)到期还款,因综合成本相同均为4.785%,可倒算出融资利率</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs copy">33,088.17*4.785%*180/360= 791.63<br>2,634.31*7.2*0.0945%+13,768.56 *4.448%*146/360= 266.29<br>合计: 791.63+266.294= 1,057.92,与(1)中财务费用相同<br></code></pre></td></tr></table></figure><p>(2)如果12月17日提前还款,开证费为0.0945%,三笔业务的费用</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs copy">33,088.17*4.785%*16/360= 70.37<br>2,634.31*7.2*0.0945%+10,951.57*4.448%*108/360+(13,768.56-10,951.57)*4.448%*146/360=  214.88<br>合计: 70.37+214.88= 285.25<br></code></pre></td></tr></table></figure><p>因开证费由0.0945%变更为0.35%,12月17日提前还款导致多支出财务费用295.27-285.25&#x3D;10.02万元,且该损失均由信用证项下进口押汇提前还款造成.</p><p>结论一:</p><p>(1)方案二优于方案一,但优于方案二的TT项下融资刚发生,容易忽视</p><p>(2)在授信不足的情况下做TT项下进口押汇毫无意义.</p><p>可将额度用于开立进口证,TT押汇直接TT.</p>]]></content>
    
    
    <categories>
      
      <category>经济</category>
      
      <category>金融</category>
      
    </categories>
    
    
    <tags>
      
      <tag>原创</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>发货前开立信用证应该如何开</title>
    <link href="/2023/12/06/%E5%8F%91%E8%B4%A7%E5%89%8D%E5%BC%80%E7%AB%8B%E4%BF%A1%E7%94%A8%E8%AF%81%E5%BA%94%E8%AF%A5%E5%A6%82%E4%BD%95%E5%BC%80/"/>
    <url>/2023/12/06/%E5%8F%91%E8%B4%A7%E5%89%8D%E5%BC%80%E7%AB%8B%E4%BF%A1%E7%94%A8%E8%AF%81%E5%BA%94%E8%AF%A5%E5%A6%82%E4%BD%95%E5%BC%80/</url>
    
    <content type="html"><![CDATA[<h3 id="一、合同签订后5个银行工作日内开立信用证，开证后5日内发货"><a href="#一、合同签订后5个银行工作日内开立信用证，开证后5日内发货" class="headerlink" title="一、合同签订后5个银行工作日内开立信用证，开证后5日内发货"></a>一、合同签订后5个银行工作日内开立信用证，开证后5日内发货</h3><p>合同签订后开证前卖方提供下列副本材料，如卖方无法提供完整材料，则开证最后期限从提供完整材料日开始计算：</p><h5 id="1-SGS-reports-of-Quality-and-Quantity-of-Loading-port"><a href="#1-SGS-reports-of-Quality-and-Quantity-of-Loading-port" class="headerlink" title="(1) SGS reports of Quality and Quantity of Loading port"></a>(1) SGS reports of Quality and Quantity of Loading port</h5><p>装货港数量及质量SGS商检报告</p><h5 id="2-Certificate-of-origin"><a href="#2-Certificate-of-origin" class="headerlink" title="(2) Certificate of origin"></a>(2) Certificate of origin</h5><p>原产地证明书 </p><h5 id="3-Tank-Storage-Receipt-TSR"><a href="#3-Tank-Storage-Receipt-TSR" class="headerlink" title="(3) Tank Storage Receipt (TSR)"></a>(3) Tank Storage Receipt (TSR)</h5><p>储罐存储收据</p><h5 id="4-Charter-Party-Agreement-CPA"><a href="#4-Charter-Party-Agreement-CPA" class="headerlink" title="(4) Charter Party Agreement (CPA)"></a>(4) Charter Party Agreement (CPA)</h5><p>租船合同</p><h5 id="5-Commitment-assurance-letter-to-supply"><a href="#5-Commitment-assurance-letter-to-supply" class="headerlink" title="(5) Commitment assurance letter to supply"></a>(5) Commitment assurance letter to supply</h5><p>炼油厂供应产品的承诺</p><h5 id="6-Statement-of-product-availability"><a href="#6-Statement-of-product-availability" class="headerlink" title="(6) Statement of product availability"></a>(6) Statement of product availability</h5><p>产品可用性声明 </p><h5 id="7-License-to-Export-Issued-by-the-Department-of-the-Ministry-of-Energy"><a href="#7-License-to-Export-Issued-by-the-Department-of-the-Ministry-of-Energy" class="headerlink" title="(7) License to Export, Issued by the Department of the Ministry of Energy"></a>(7) License to Export, Issued by the Department of the Ministry of Energy</h5><p>能源部颁发的出口许可证</p><h5 id="8-Approval-to-Export-Issued-by-the-Department-of-the-Ministry-of-Justice"><a href="#8-Approval-to-Export-Issued-by-the-Department-of-the-Ministry-of-Justice" class="headerlink" title="(8) Approval to Export, Issued by the Department of the Ministry of Justice"></a>(8) Approval to Export, Issued by the Department of the Ministry of Justice</h5><p>司法部颁发的出口批准</p><h3 id="二、开证后5日内发货并提供下列副本材料-否则无条件同意撤证"><a href="#二、开证后5日内发货并提供下列副本材料-否则无条件同意撤证" class="headerlink" title="二、开证后5日内发货并提供下列副本材料,否则无条件同意撤证"></a>二、开证后5日内发货并提供下列副本材料,否则无条件同意撤证</h3><h5 id="1-Q88"><a href="#1-Q88" class="headerlink" title="(1)Q88"></a>(1)Q88</h5><p>装载货船Q88</p><h5 id="2-Cargo-manifest"><a href="#2-Cargo-manifest" class="headerlink" title="(2) Cargo manifest"></a>(2) Cargo manifest</h5><p>货物舱单</p><h5 id="3-Bill-of-landing"><a href="#3-Bill-of-landing" class="headerlink" title="(3) Bill of landing"></a>(3) Bill of landing</h5><p>提单</p><h5 id="4-Certificate-of-Insurance-issued-by-internationally-recognized-insurance-company"><a href="#4-Certificate-of-Insurance-issued-by-internationally-recognized-insurance-company" class="headerlink" title="(4) Certificate of Insurance issued by internationally recognized insurance company"></a>(4) Certificate of Insurance issued by internationally recognized insurance company</h5><p>国际公认的保险公司出具的保单</p><h5 id="5-The-Authorization-to-Board-ATB-the-Vessel-for-inspection"><a href="#5-The-Authorization-to-Board-ATB-the-Vessel-for-inspection" class="headerlink" title="(5) The Authorization to Board (ATB) the Vessel for inspection."></a>(5) The Authorization to Board (ATB) the Vessel for inspection.</h5><p>船检授权</p><h5 id="6-Other-documents-required-by-the-buyer-for-customs-registration-for-import-which-the-seller-needs-to-cooperate-in-providing"><a href="#6-Other-documents-required-by-the-buyer-for-customs-registration-for-import-which-the-seller-needs-to-cooperate-in-providing" class="headerlink" title="(6) Other documents required by the buyer for customs registration for import, which the seller needs to cooperate in providing."></a>(6) Other documents required by the buyer for customs registration for import, which the seller needs to cooperate in providing.</h5><p>买方进口海关备案需要卖方配合提供的其他材料</p><h3 id="三、信用证交单材料-原件"><a href="#三、信用证交单材料-原件" class="headerlink" title="三、信用证交单材料(原件):"></a>三、信用证交单材料(原件):</h3><h5 id="1-Seller’s-signed-commercial-invoice-in-3-original-and-2-copy"><a href="#1-Seller’s-signed-commercial-invoice-in-3-original-and-2-copy" class="headerlink" title="(1) Seller’s signed commercial invoice in 3 original and 2 copy"></a>(1) Seller’s signed commercial invoice in 3 original and 2 copy</h5><p>卖方签署的商业发票 3正2副</p><h5 id="2-3-original-bills-of-landing-issued-or-made-out-to-the-order-of-the-buyer"><a href="#2-3-original-bills-of-landing-issued-or-made-out-to-the-order-of-the-buyer" class="headerlink" title="(2) 3 original bills of landing issued or made out to the order of the buyer"></a>(2) 3 original bills of landing issued or made out to the order of the buyer</h5><p>3&#x2F;3正本提单由申请人签署或背书给买方</p><h5 id="3-Original-certificate-of-origin"><a href="#3-Original-certificate-of-origin" class="headerlink" title="(3) Original certificate of origin."></a>(3) Original certificate of origin.</h5><p>原产地证原件</p><h5 id="4-Original-certificates-of-quantity-and-quality-of-loading-port-issued-or-countersigned-by-independent-inspectors"><a href="#4-Original-certificates-of-quantity-and-quality-of-loading-port-issued-or-countersigned-by-independent-inspectors" class="headerlink" title="(4) Original certificates of quantity and quality of loading port issued or countersigned by independent inspectors."></a>(4) Original certificates of quantity and quality of loading port issued or countersigned by independent inspectors.</h5><p>由独立三方商检出具或签署的装货港数和质量报告原件</p><h5 id="5-Original-Certificate-of-quantity-of-discharge-port-tamped-with-the-buyer’s-red-seal"><a href="#5-Original-Certificate-of-quantity-of-discharge-port-tamped-with-the-buyer’s-red-seal" class="headerlink" title="(5) Original Certificate of quantity of discharge port tamped with the buyer’s red seal."></a>(5) Original Certificate of quantity of discharge port tamped with the buyer’s red seal.</h5><p>卸货港数量证明加盖买方红色印章的原件</p><h5 id="6-Original-Cargo-manifest"><a href="#6-Original-Cargo-manifest" class="headerlink" title="(6) Original Cargo manifest"></a>(6) Original Cargo manifest</h5><p>货物舱单原件</p>]]></content>
    
    
    <categories>
      
      <category>经济</category>
      
      <category>进口贸易</category>
      
    </categories>
    
    
    <tags>
      
      <tag>原创</tag>
      
      <tag>外汇</tag>
      
      <tag>进口信用证</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Word引用Excel单元格数据的VBA方法</title>
    <link href="/2023/12/05/Word%E5%BC%95%E7%94%A8Excel%E5%8D%95%E5%85%83%E6%A0%BC%E6%95%B0%E6%8D%AE%E7%9A%84VBA%E6%96%B9%E6%B3%95/"/>
    <url>/2023/12/05/Word%E5%BC%95%E7%94%A8Excel%E5%8D%95%E5%85%83%E6%A0%BC%E6%95%B0%E6%8D%AE%E7%9A%84VBA%E6%96%B9%E6%B3%95/</url>
    
    <content type="html"><![CDATA[<p>​      日报类工作,经常会遇到从excel复制数据到word文档的情况,利用word的书签及宏功能,本文尝试用粗糙的VBA编码,大大降低这种工作的繁琐程度。</p><h5 id="新建一个控制按钮关联上下面的代码就可以了-原理都在里面-可以根据自己的情况进行修改"><a href="#新建一个控制按钮关联上下面的代码就可以了-原理都在里面-可以根据自己的情况进行修改" class="headerlink" title="新建一个控制按钮关联上下面的代码就可以了,原理都在里面,可以根据自己的情况进行修改:"></a>新建一个控制按钮关联上下面的代码就可以了,原理都在里面,可以根据自己的情况进行修改:</h5><figure class="highlight vb"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br></pre></td><td class="code"><pre><code class="hljs vb"><span class="hljs-keyword">Private</span> <span class="hljs-keyword">Sub</span> CommandButton1_Click()<br><br>    <span class="hljs-keyword">Dim</span> excelApp <span class="hljs-keyword">As</span> <span class="hljs-type">Object</span><br>    <span class="hljs-keyword">Dim</span> excelWorkbook <span class="hljs-keyword">As</span> <span class="hljs-type">Object</span><br>    <span class="hljs-keyword">Dim</span> excelSheet <span class="hljs-keyword">As</span> <span class="hljs-type">Object</span><br>    <span class="hljs-keyword">Dim</span> wordApp <span class="hljs-keyword">As</span> <span class="hljs-type">Object</span><br>    <span class="hljs-keyword">Dim</span> wordDoc <span class="hljs-keyword">As</span> <span class="hljs-type">Object</span><br><br>    <span class="hljs-comment">&#x27; 创建 Excel 应用程序对象</span><br>    <span class="hljs-keyword">Set</span> excelApp = CreateObject(<span class="hljs-string">&quot;Excel.Application&quot;</span>)<br>    <span class="hljs-comment">&#x27; 打开 Excel 工作簿</span><br>    <span class="hljs-keyword">Set</span> excelWorkbook = excelApp.Workbooks.Open(<span class="hljs-string">&quot;C:\Users\Administrator\Desktop\111.xlsx&quot;</span>)<br>    <span class="hljs-comment">&#x27; 打开 Word 文档</span><br>    <span class="hljs-keyword">Set</span> wordDoc = ThisDocument<br>    <span class="hljs-comment">&#x27; 选择 Excel 工作表</span><br><span class="hljs-comment">&#x27;-------------------------------------------------------------------------------------</span><br>    <span class="hljs-keyword">Set</span> excelSheet = excelWorkbook.Sheets(<span class="hljs-string">&quot;授信汇总&quot;</span>)<br>    <span class="hljs-comment">&#x27; 获取 Excel 中的数据（假设要从 M2、M3、M4 单元格获取）</span><br>    <span class="hljs-keyword">Dim</span> excelData1 <span class="hljs-keyword">As</span> Variant<br>    <span class="hljs-keyword">Dim</span> excelData2 <span class="hljs-keyword">As</span> Variant<br>    <span class="hljs-keyword">Dim</span> excelData3 <span class="hljs-keyword">As</span> Variant<br>    <br>    excelData1 = excelSheet.Range(<span class="hljs-string">&quot;M2&quot;</span>).Value<br>    excelData2 = excelSheet.Range(<span class="hljs-string">&quot;M3&quot;</span>).Value<br>    excelData3 = excelSheet.Range(<span class="hljs-string">&quot;M4&quot;</span>).Value<br>    <br>    <span class="hljs-comment">&#x27; 将数据更新到 Word 文档的指定位置</span><br>    wordDoc.Bookmarks(<span class="hljs-string">&quot;授信总额度&quot;</span>).Range.<span class="hljs-keyword">Text</span> = excelData1<br>    wordDoc.Bookmarks(<span class="hljs-string">&quot;可使用额度&quot;</span>).Range.<span class="hljs-keyword">Text</span> = excelData2<br>    wordDoc.Bookmarks(<span class="hljs-string">&quot;授信占用&quot;</span>).Range.<span class="hljs-keyword">Text</span> = excelData3<br>    <span class="hljs-comment">&#x27; 获取 Word 书签的范围</span><br><br>    <span class="hljs-keyword">Set</span> bookmarkRange = wordDoc.Bookmarks(<span class="hljs-string">&quot;整体敞口授信及占用情况&quot;</span>).Range<br>    <span class="hljs-comment">&#x27; 获取 Excel 中的指定范围（A1:I36）的数据</span><br>    <span class="hljs-keyword">Set</span> excelRange = excelSheet.Range(<span class="hljs-string">&quot;A1:I36&quot;</span>) <br>    <span class="hljs-comment">&#x27; 将 Excel 数据插入到 Word 书签范围</span><br>    excelRange.Copy <br>    bookmarkRange.PasteSpecial  <br><span class="hljs-comment">&#x27;-------------------------------------------------------------------------------------</span><br>    <span class="hljs-keyword">Set</span> excelSheet = excelWorkbook.Sheets(<span class="hljs-string">&quot;近4个月到期授信&quot;</span>)<br>    excelData1 = excelSheet.Range(<span class="hljs-string">&quot;L2&quot;</span>).Value<br>    excelData2 = excelSheet.Range(<span class="hljs-string">&quot;L3&quot;</span>).Value<br>    excelData3 = excelSheet.Range(<span class="hljs-string">&quot;L4&quot;</span>).Value<br>    <br>    wordDoc.Bookmarks(<span class="hljs-string">&quot;到期授信&quot;</span>).Range.<span class="hljs-keyword">Text</span> = excelData1<br>    wordDoc.Bookmarks(<span class="hljs-string">&quot;计划续作&quot;</span>).Range.<span class="hljs-keyword">Text</span> = excelData2<br>    wordDoc.Bookmarks(<span class="hljs-string">&quot;预计压降&quot;</span>).Range.<span class="hljs-keyword">Text</span> = excelData3<br>    <br>    <span class="hljs-keyword">Set</span> bookmarkRange = wordDoc.Bookmarks(<span class="hljs-string">&quot;到期的授信情况&quot;</span>).Range <br>    <span class="hljs-keyword">Set</span> excelRange = excelSheet.Range(<span class="hljs-string">&quot;A1:I10&quot;</span>) <br>    excelRange.Copy <br>    bookmarkRange.PasteSpecial <br><span class="hljs-comment">&#x27;-------------------------------------------------------------------------------------</span><br>    <span class="hljs-keyword">Set</span> excelSheet = excelWorkbook.Sheets(<span class="hljs-string">&quot;近四个月还款&quot;</span>)<br>    excelData1 = excelSheet.Range(<span class="hljs-string">&quot;L2&quot;</span>).Value<br>    excelData2 = excelSheet.Range(<span class="hljs-string">&quot;L3&quot;</span>).Value<br>    excelData3 = excelSheet.Range(<span class="hljs-string">&quot;L4&quot;</span>).Value<br>    <br>   <span class="hljs-comment">&#x27; 格式化数据为两位小数</span><br>    <span class="hljs-keyword">Dim</span> formattedData1 <span class="hljs-keyword">As</span> <span class="hljs-type">String</span><br>    <span class="hljs-keyword">Dim</span> formattedData2 <span class="hljs-keyword">As</span> <span class="hljs-type">String</span><br>    <span class="hljs-keyword">Dim</span> formattedData3 <span class="hljs-keyword">As</span> <span class="hljs-type">String</span><br>    <br>    formattedData1 = Format(excelData1, <span class="hljs-string">&quot;#,##0.00&quot;</span>)<br>    formattedData2 = Format(excelData2, <span class="hljs-string">&quot;#,##0.00&quot;</span>)<br>    formattedData3 = Format(excelData3, <span class="hljs-string">&quot;#,##0.00&quot;</span>)<br>    <br>    wordDoc.Bookmarks(<span class="hljs-string">&quot;敞口总额&quot;</span>).Range.<span class="hljs-keyword">Text</span> = formattedData1<br>    wordDoc.Bookmarks(<span class="hljs-string">&quot;正常续作&quot;</span>).Range.<span class="hljs-keyword">Text</span> = formattedData2<br>    wordDoc.Bookmarks(<span class="hljs-string">&quot;净压降&quot;</span>).Range.<span class="hljs-keyword">Text</span> = formattedData3<br>    <br>    <span class="hljs-keyword">Set</span> bookmarkRange = wordDoc.Bookmarks(<span class="hljs-string">&quot;还款及续作的情况&quot;</span>).Range <br>    <span class="hljs-keyword">Set</span> excelRange = excelSheet.Range(<span class="hljs-string">&quot;A1:I67&quot;</span>) <br>    excelRange.Copy <br>    bookmarkRange.PasteSpecial    <br><span class="hljs-comment">&#x27;-------------------------------------------------------------------------------------</span><br>    <span class="hljs-keyword">Set</span> excelSheet = excelWorkbook.Sheets(<span class="hljs-string">&quot;本月已完成&quot;</span>)<br>    excelData1 = excelSheet.Range(<span class="hljs-string">&quot;M2&quot;</span>).Value<br>    excelData2 = excelSheet.Range(<span class="hljs-string">&quot;M3&quot;</span>).Value<br>    excelData3 = excelSheet.Range(<span class="hljs-string">&quot;M4&quot;</span>).Value<br>    excelData4 = excelSheet.Range(<span class="hljs-string">&quot;M4&quot;</span>).Value<br><br>    <span class="hljs-keyword">Dim</span> formattedData4 <span class="hljs-keyword">As</span> <span class="hljs-type">String</span><br>    <br>    formattedData1 = Format(excelData1, <span class="hljs-string">&quot;#,##0.00&quot;</span>)<br>    formattedData2 = Format(excelData2, <span class="hljs-string">&quot;#,##0.00&quot;</span>)<br>    formattedData3 = Format(excelData3, <span class="hljs-string">&quot;#,##0.00&quot;</span>)<br>    formattedData4 = Format(excelData4, <span class="hljs-string">&quot;#,##0.00&quot;</span>)<br>    <br>    wordDoc.Bookmarks(<span class="hljs-string">&quot;贷款敞口&quot;</span>).Range.<span class="hljs-keyword">Text</span> = formattedData1<br>    wordDoc.Bookmarks(<span class="hljs-string">&quot;完成续作&quot;</span>).Range.<span class="hljs-keyword">Text</span> = formattedData2<br>    wordDoc.Bookmarks(<span class="hljs-string">&quot;已新增&quot;</span>).Range.<span class="hljs-keyword">Text</span> = formattedData3<br>    wordDoc.Bookmarks(<span class="hljs-string">&quot;已压降&quot;</span>).Range.<span class="hljs-keyword">Text</span> = formattedData4<br><span class="hljs-comment">&#x27;-------------------------------------------------------------------------------------</span><br>    <span class="hljs-keyword">Set</span> excelSheet = excelWorkbook.Sheets(<span class="hljs-string">&quot;计划新增授信&quot;</span>)<br>    <br>    <span class="hljs-keyword">Set</span> bookmarkRange = wordDoc.Bookmarks(<span class="hljs-string">&quot;新增授信情况&quot;</span>).Range <br>    <span class="hljs-keyword">Set</span> excelRange = excelSheet.Range(<span class="hljs-string">&quot;A1:H6&quot;</span>)<br>    excelRange.Copy <br>    bookmarkRange.PasteSpecial    <br><span class="hljs-comment">&#x27;-------------------------------------------------------------------------------------</span><br>    <span class="hljs-keyword">Set</span> excelSheet = excelWorkbook.Sheets(<span class="hljs-string">&quot;新增授信汇总&quot;</span>)<br>    <br>    <span class="hljs-keyword">Set</span> bookmarkRange = wordDoc.Bookmarks(<span class="hljs-string">&quot;具体明细如下&quot;</span>).Range <br>    <span class="hljs-keyword">Set</span> excelRange = excelSheet.Range(<span class="hljs-string">&quot;A1:D18&quot;</span>) <br>    excelRange.Copy <br>    bookmarkRange.PasteSpecial    <br><span class="hljs-comment">&#x27;-------------------------------------------------------------------------------------</span><br>    <span class="hljs-keyword">Set</span> excelSheet = <span class="hljs-literal">Nothing</span><br>   <span class="hljs-comment">&#x27; 打开 Excel 工作簿</span><br>    <span class="hljs-keyword">Set</span> excelWorkbook = excelApp.Workbooks.Open(<span class="hljs-string">&quot;C:\Users\Administrator\Desktop\222.xlsx&quot;</span>)<br>    <span class="hljs-comment">&#x27; 选择 Excel 工作表</span><br>    <span class="hljs-keyword">Set</span> excelSheet = excelWorkbook.Sheets(<span class="hljs-string">&quot;报件皮&quot;</span>)<br>    excelData1 = excelSheet.Range(<span class="hljs-string">&quot;A5:A16&quot;</span>).Value<br>    <span class="hljs-comment">&#x27; 将数据逐个添加到字符串，换行符号隔开</span><br>    <span class="hljs-keyword">Dim</span> dataArray <span class="hljs-keyword">As</span> <span class="hljs-type">String</span><br>    <span class="hljs-keyword">For</span> i = LBound(excelData1, <span class="hljs-number">1</span>) <span class="hljs-keyword">To</span> UBound(excelData1, <span class="hljs-number">1</span>)<br>        dataArray = dataArray &amp; excelData1(i, <span class="hljs-number">1</span>) &amp; vbCrLf<br>    <span class="hljs-keyword">Next</span> i<br>        <span class="hljs-comment">&#x27; 将数据更新到 Word 文档的指定位置</span><br>    wordDoc.Bookmarks(<span class="hljs-string">&quot;当日发生业务&quot;</span>).Range.<span class="hljs-keyword">Text</span> = dataArray<br><span class="hljs-comment">&#x27;-------------------------------------------------------------------------------------</span><br>    <span class="hljs-comment">&#x27; 关闭 Excel 工作簿</span><br>    excelWorkbook.Close<br>    <span class="hljs-comment">&#x27; 释放对象</span><br>    <span class="hljs-keyword">Set</span> excelSheet = <span class="hljs-literal">Nothing</span><br>    <span class="hljs-keyword">Set</span> excelWorkbook = <span class="hljs-literal">Nothing</span><br>    <span class="hljs-keyword">Set</span> bookmarkRange = <span class="hljs-literal">Nothing</span><br>    <span class="hljs-keyword">Set</span> excelRange = <span class="hljs-literal">Nothing</span><br>    <span class="hljs-keyword">Set</span> excelApp = <span class="hljs-literal">Nothing</span><br>    <span class="hljs-keyword">Set</span> wordDoc = <span class="hljs-literal">Nothing</span><br>    <br>    <span class="hljs-comment">&#x27; 关闭 Excel 应用程序</span><br>    <span class="hljs-keyword">If</span> <span class="hljs-built_in">Not</span> excelApp <span class="hljs-built_in">Is</span> <span class="hljs-literal">Nothing</span> <span class="hljs-keyword">Then</span><br>        excelApp.Quit<br>        <span class="hljs-keyword">Set</span> excelApp = <span class="hljs-literal">Nothing</span><br>    <span class="hljs-keyword">End</span> <span class="hljs-keyword">If</span><br>    <br>    <span class="hljs-comment">&#x27; 结束 Excel 进程</span><br>    <span class="hljs-keyword">On</span> <span class="hljs-keyword">Error</span> <span class="hljs-keyword">Resume</span> <span class="hljs-keyword">Next</span><br>    <span class="hljs-keyword">Dim</span> excelProcess <span class="hljs-keyword">As</span> <span class="hljs-type">Object</span><br>    <span class="hljs-keyword">For</span> <span class="hljs-keyword">Each</span> excelProcess <span class="hljs-keyword">In</span> GetObject(<span class="hljs-string">&quot;winmgmts:&quot;</span>).ExecQuery(<span class="hljs-string">&quot;Select * from Win32_Process Where Name = &#x27;EXCEL.EXE&#x27;&quot;</span>)<br>        excelProcess.Terminate<br>    <span class="hljs-keyword">Next</span><br>    <span class="hljs-keyword">On</span> <span class="hljs-keyword">Error</span> <span class="hljs-keyword">GoTo</span> <span class="hljs-number">0</span><br><span class="hljs-keyword">End</span> <span class="hljs-keyword">Sub</span><br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>IT</category>
      
      <category>Office</category>
      
    </categories>
    
    
    <tags>
      
      <tag>原创</tag>
      
      <tag>Excel</tag>
      
      <tag>宏</tag>
      
      <tag>VBA</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>系统升级日志-(1)数据录入规范判断触发键</title>
    <link href="/2023/11/30/%E7%B3%BB%E7%BB%9F%E5%8D%87%E7%BA%A7%E6%97%A5%E5%BF%97-(1)%E6%95%B0%E6%8D%AE%E5%BD%95%E5%85%A5%E8%A7%84%E8%8C%83%E5%88%A4%E6%96%AD%E8%A7%A6%E5%8F%91%E9%94%AE/"/>
    <url>/2023/11/30/%E7%B3%BB%E7%BB%9F%E5%8D%87%E7%BA%A7%E6%97%A5%E5%BF%97-(1)%E6%95%B0%E6%8D%AE%E5%BD%95%E5%85%A5%E8%A7%84%E8%8C%83%E5%88%A4%E6%96%AD%E8%A7%A6%E5%8F%91%E9%94%AE/</url>
    
    <content type="html"><![CDATA[<p>历史更新:</p><p><a href="https://moranwuyu.gitee.io/2023/11/30/%E7%B3%BB%E7%BB%9F%E5%8D%87%E7%BA%A7%E6%97%A5%E5%BF%97-(1)%E6%95%B0%E6%8D%AE%E5%BD%95%E5%85%A5%E8%A7%84%E8%8C%83%E5%88%A4%E6%96%AD%E8%A7%A6%E5%8F%91%E9%94%AE/">(1) 增加数据录入是否规范的触发键</a></p><h5 id="触发键-对数据录入是否规范进行判断并弹出提示"><a href="#触发键-对数据录入是否规范进行判断并弹出提示" class="headerlink" title="触发键:对数据录入是否规范进行判断并弹出提示:"></a>触发键:对数据录入是否规范进行判断并弹出提示:</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><code class="hljs mysql">BEGIN<br>-- 更新&quot;责任人&quot;和&quot;首次录入时间&quot;字段<br>    SET NEW.责任人= SUBSTRING_INDEX(USER(), &#x27;@&#x27;, 1);<br>    SET NEW.首次录入时间= NOW();<br><br>-- 错误判断<br>IF NEW.还款金额 &lt;&gt; &#x27;0.00&#x27; AND NEW.还款金额 &lt;&gt; NEW.放款金额 THEN<br>SIGNAL SQLSTATE &#x27;45000&#x27;<br>SET MESSAGE_TEXT = &#x27;录入错误：&quot;还款金额&quot;只能等于&quot;放款金额&quot;或等于&quot;0.00&quot;&#x27;;<br>END IF;<br><br>IF NEW.还款金额 = &#x27;0.00&#x27; AND NEW.还款日期 is not NULL THEN<br>SIGNAL SQLSTATE &#x27;45000&#x27;<br>SET MESSAGE_TEXT = &#x27;录入错误：没有还款!请将&quot;还款日期&quot;的值设为&quot;NULL&quot;&#x27;;<br>END IF;<br><br>IF NEW.还款金额 = NEW.放款金额 AND NEW.还款日期 is NULL THEN<br>SIGNAL SQLSTATE &#x27;45000&#x27;<br>SET MESSAGE_TEXT = &#x27;录入错误：已结清! 请维护&quot;还款日期&quot;&#x27;;<br>END IF;<br><br>IF NEW.质押释放金额 &lt;&gt; &#x27;0.00&#x27; AND NEW.质押释放金额 &lt;&gt; NEW.质押金额 THEN<br>SIGNAL SQLSTATE &#x27;45000&#x27;<br>SET MESSAGE_TEXT = &#x27;录入错误：&quot;质押释放金额&quot;只能等于&quot;质押金额&quot;或等于&quot;0.00&quot;&#x27;;<br>END IF;<br><br>IF NEW.质押释放金额  = &#x27;0.00&#x27; AND NEW.质押释放日期  is not NULL THEN<br>SIGNAL SQLSTATE &#x27;45000&#x27;<br>SET MESSAGE_TEXT = &#x27;录入错误：无保证金释放,请将&quot;质押释放日期&quot;的值设为&quot;NULL&quot;&#x27;;<br>END IF;<br><br>IF NEW.质押释放金额 = NEW.质押金额 AND NEW.质押释放日期 is NULL AND NEW.质押金额&lt;&gt; &#x27;0.00&#x27; THEN<br>SIGNAL SQLSTATE &#x27;45000&#x27;<br>SET MESSAGE_TEXT = &#x27;录入错误：已结清! 请维护&quot;押释放日期&quot;&#x27;;<br>END IF;<br><br>-- 如果还款金额等于放款金额则更新&quot;是否结清&quot;字段<br>  IF NEW.放款金额 = NEW.还款金额 THEN<br>SET NEW.是否结清 = &#x27;是&#x27;;<br>ELSE<br>SET NEW.是否结清 = &#x27;否&#x27;;<br>END IF;<br>END<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>IT</category>
      
      <category>MySQL</category>
      
    </categories>
    
    
    <tags>
      
      <tag>原创</tag>
      
      <tag>mysql</tag>
      
      <tag>fin_details系统更新日志</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Hexo同时推送Github和Gitee</title>
    <link href="/2023/11/22/Hexo%E5%90%8C%E6%97%B6%E6%8E%A8%E9%80%81Github%E5%92%8CGitee/"/>
    <url>/2023/11/22/Hexo%E5%90%8C%E6%97%B6%E6%8E%A8%E9%80%81Github%E5%92%8CGitee/</url>
    
    <content type="html"><![CDATA[<p>前提:已清楚如何推送github</p><p>更新后github推送mainf分支,而gitee仍然是master,本地可通过修改_config.yml中的deploy块来实现同时推送Github和Gitee,代码如下:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs copy">deploy:<br>  - type: git<br>    repo: https://github.com/xxx/xxx.github.io.git<br>    branch: main<br>    token: xxxxxxxxxxxxxxxx<br><br>  - type: git<br>    repo: https://gitee.com/xxx/xxx.git<br>    branch: master<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>IT</category>
      
      <category>Hexo</category>
      
    </categories>
    
    
    <tags>
      
      <tag>原创</tag>
      
      <tag>Hexo</tag>
      
      <tag>fluid</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>外币融资策略</title>
    <link href="/2023/11/21/%E5%A4%96%E5%B8%81%E8%9E%8D%E8%B5%84%E7%AD%96%E7%95%A5/"/>
    <url>/2023/11/21/%E5%A4%96%E5%B8%81%E8%9E%8D%E8%B5%84%E7%AD%96%E7%95%A5/</url>
    
    <content type="html"><![CDATA[<h4 id="尝试解决的问题"><a href="#尝试解决的问题" class="headerlink" title="尝试解决的问题:"></a>尝试解决的问题:</h4><p>1.签订采购合同使用欧元结算还是以美元结算？<br>2.付款时选择直接付款还是选择融资？<br>3.融资的币种选择欧元还是美元？<br>4.挂单的成本点如何选择？</p><h3 id="一、合同签订-2020年2月21日"><a href="#一、合同签订-2020年2月21日" class="headerlink" title="一、合同签订(2020年2月21日)"></a>一、合同签订(2020年2月21日)</h3><h5 id="购买产品-A油品"><a href="#购买产品-A油品" class="headerlink" title="购买产品:A油品"></a>购买产品:A油品</h5><h5 id="基本信息"><a href="#基本信息" class="headerlink" title="基本信息:"></a>基本信息:</h5><p>1.上限数量48400吨， 分2船装运。</p><p>2.计价期2020&#x2F;02&#x2F;12-2020&#x2F;02&#x2F;28，合同签订日计价期未结束，但可预估截止2月20日单价533.047美元&#x2F;吨，A油品价格处于下行趋势，计价期选择延后的策略是正确的。4月份MOPJ均价达到历史低点194.220美元&#x2F;吨，如果计价期可以继续延期至4月份将更有利于买方。<br><img src="https://www.z4a.net/images/2023/11/21/_20231121113653.jpg" alt="MOPJ走势图"></p><p><img src="https://www.z4a.net/images/2023/11/21/_20231121113702.jpg" alt="原油期货SC2009"><br>因此,A油品从洽谈到合同签订阶段汇率策略应为:</p><ul><li>价格处于下降通道，延后计价期，使结算MOPJ均价降低；</li><li>价格处于上升通道，提前计价期，使结算MOPJ均价取低值。</li><li>更近一步，如果企业无法准确的预知价格趋势，可通过买卖原油远期对冲价格敞口，上图可以看出原油期货走向和A油品价格走势高度相关（相关产品链接）。</li></ul><p>3.美元计价欧元结算，欧兑美汇率使用彭博社（BFIX）2020年3月2日公布的欧兑美汇率，该日期为计价期结束后2日，合同洽谈阶段至签订时汇率未公布，汇率处于长期调整阶段，很难清晰的判断汇率的走向，从而调整计价期，而实际央行公布的欧兑美汇率2月21日-3月2日汇率由1.0846上涨至1.1133，上涨47bps，对于该笔以欧元结算美元计价的合同来说，此行为为企业节省了成本</p><p><code>47816.204*519.337/1.0846-47816.204* 519.337/1.1133=EUR590,234.30</code></p><p>折人民币4,849,837.24万元。<br><img src="https://www.z4a.net/images/2023/11/21/111.png" alt="2020年2月21日央行欧兑美参考汇率收盘价（wind数据）"><br><img src="https://www.z4a.net/images/2023/11/21/222.png" alt="wind:2020年2月21日央行欧兑美参考汇率收盘价"></p><p>因此,对于美元计价欧元结算合同的需方，从洽谈到合同签订这个阶段的汇率策略应为:</p><ul><li>欧兑美汇率处于上升通道，延后计价期，使结算汇率取高值；</li><li>欧兑美汇率处于下降通道，提前计价期，使结算汇率取高值。</li></ul><h3 id="二、开立进口信用证2600万欧元（2020年3月3日）"><a href="#二、开立进口信用证2600万欧元（2020年3月3日）" class="headerlink" title="二、开立进口信用证2600万欧元（2020年3月3日）"></a>二、开立进口信用证2600万欧元（2020年3月3日）</h3><p>1、计价期2月28日结束，结算单价确定519.337元&#x2F;吨,第1船数量确定24084.979吨，2020&#x2F;2&#x2F;21起运，第2船2020&#x2F;3&#x2F;30起运数量未确定。</p><p>2、2020&#x2F;3&#x2F;2 BFIX汇率1.1113，北京时间比德国法兰克福时间快6小时因为时差开证日下午3点才能知道准确汇率。</p><p><img src="https://www.z4a.net/images/2023/11/21/_20231121121806.jpg" alt="开证金额计算"><br>需方采购部门给出开证金额计算过程金额为2600万欧元，而3月3日结算单价已经确定，欧兑美汇率基本确定，稍作调整可以计算出更为准确定开证金额:</p><p><code>48400*519.337/1.1113= EUR 22,618,474.58</code></p><p>因此，开证金额比实际需要的开证金额高出EUR 3,381,525.42，多占用银行授信:</p><p><code>3,381,525.42*7.6714=CNY 25,941,034.11</code></p><p>至5月14日第2船完成付款信用证额度释放，增加开证费:</p><p><code>25,941,034.11*0.0675%=CNY 17,510.20</code></p><p>可以看出,财务成本已经额外增加,卖方双方、内部财务跟采购部门、财务跟银行的有效沟通，可以有效的降低成本。</p><h3 id="三、第1船海外代付付款（2020年4月3日）"><a href="#三、第1船海外代付付款（2020年4月3日）" class="headerlink" title="三、第1船海外代付付款（2020年4月3日）"></a>三、第1船海外代付付款（2020年4月3日）</h3><table><thead><tr><th align="center">序号</th><th>日期</th><th>事项</th><th>成交汇率</th><th>Wind欧元汇率收盘价</th></tr></thead><tbody><tr><td align="center">1</td><td>2020&#x2F;2&#x2F;21</td><td>合同签订</td><td></td><td>7.6037</td></tr><tr><td align="center">2</td><td>2020&#x2F;3&#x2F;3</td><td>开证</td><td></td><td>7.7665</td></tr><tr><td align="center">3</td><td>2020&#x2F;4&#x2F;3</td><td>第1次到单融资付款</td><td></td><td>7.6618</td></tr><tr><td align="center">4</td><td>2020&#x2F;5&#x2F;14</td><td>第2次到单融资付款</td><td></td><td>7.6714</td></tr><tr><td align="center">5</td><td>2020&#x2F;5&#x2F;18</td><td>EUR11255485.23+EUR20791.38挂单成交</td><td>7.6939</td><td>7.6932</td></tr><tr><td align="center">6</td><td>2020&#x2F;8&#x2F;13</td><td>EUR3000000.00+EUR38918.60即期购汇提前还款</td><td>8.2336</td><td>8.2128</td></tr><tr><td align="center">7</td><td>2020&#x2F;8&#x2F;14</td><td>EUR8090167.55+EUR311.98即期购汇提前还款</td><td>8.2000</td><td>8.2168</td></tr><tr><td align="center">8</td><td>2020&#x2F;8&#x2F;14</td><td>EUR11255485.23+EUR20791.38锁汇到期交割</td><td>7.6939</td><td>8.2000</td></tr></tbody></table><p>1.欧元付款金额EUR 11,255,485.23 付款日在银行办理海外代付支付，到期日2020年8月14日，期限133天利率libor6+170bps&#x3D;1.51457%,承兑费0.1%（已收取€11,255.49）；<br>代付利息前端收取:<br><code>€11,255,485.23*1.01457%*133/360-€11,255.49=€30,933.14</code><br>代付利息0.5%到期支付:<br><code>€11,255,485.23*0.5%*133/360=€20,791.38</code><br>同时在银行办理挂单锁汇，成本点7.3939。</p><p>2.如果不在银行办理融资4月3日需支付人民币<br><code>€11,255,485.23*7.6618=￥86,237,276.74。</code>如果办理融资:</p><ul><li>银行融资锁汇的情况，4月3日支付费用<br><code>EUR（30,933.14+11,255.49）*7.6618=CNY323,240.85</code><br>8月14日支付费用:<br><code>EUR20,791.38*7.6939=CNY159,966.80</code><br>到期支付本金:<br><code>EUR11,255,485.23*7.6939=CNY86,598,577.81</code><br>本息费合计:<br><code>323,240.85+159,966.80+86,598,577.81=CNY 87,081,785.46</code><br>锁汇融资成本:<br><code>（87,081,785.46-86,237,276.74）/86,237,276.74*360/133=2.65%</code><br>其中:融资费用为1.51457%，汇兑损益1.13613%；汇兑损益主要为远期锁汇期权的成本上，该数值在可接受范围内。</li><li>如果未锁汇成功,4月3日支付费用:<br><code>EUR（30,933.14+11,255.49）*7.6618=CNY323,240.85</code><br>8月14日支付费用:<br><code>EUR20,791.38*8.20=CNY 170,489.32</code><br>支付本金:<br><code>EUR11,255,485.23*8.20=CNY 92,294,978.89</code><br>本息费合计:<br><code>323,240.85+170,489.32+92,294,978.89=CNY92,788,709.06</code><br>锁汇加融资成本为:<br><code>（92,788,709.06 -86,237,276.74）/86,237,276.74*360/133=20.5633%</code><br>其中:融资费用为1.51457%，汇兑损益19.04870%,<br>汇兑损益金额:<br><code>86,237,276.74*19.04870%*133/360=-CNY6,068,892.09</code></li></ul><p>综合上述，在汇率波动剧烈的情形下，可以得出以下结论:</p><ul><li>如果未成功锁汇将造成巨额汇兑亏损CNY6,068,892.09；</li><li>在巨额的汇兑损益面前，欧元融资利率低的价值几乎可以忽略不计；</li><li>锁汇挂单成本点将融资利率甚至融资手续费考虑进去是错误的</li></ul><h3 id="四、第2船银行进口押汇付款（2020年5月14日）"><a href="#四、第2船银行进口押汇付款（2020年5月14日）" class="headerlink" title="四、第2船银行进口押汇付款（2020年5月14日）"></a>四、第2船银行进口押汇付款（2020年5月14日）</h3><p>1、欧元付款金额EUR 11,090,167.55，付款日2020年5月14日，付款日在银行办理进口押汇支付，到期日2020年8月14日，期限92天贷款利率libor6+170bps&#x3D;1.58829%:承兑费0.1%；<br>押汇利息，<br><code>€11,090,167.55*1.38829%*92/360=€39,346.28</code><br>并在挂单锁汇，成本点7.6510。<br>如果不融资4月3日需支付<br><code>EUR11,090,167.55* 7.6714= CNY 85,077,111.34</code><br>挂单锁汇未成功，5月14日支付承兑费<br><code>EUR11,090,167.55*0.1%*7.6714=EUR11,090.17</code><br>8月13日银行额度不足提前还款支付利息<br><code>EUR11,090,167.55*1.38829%*91/360*8.2336= CNY320,440.17</code><br>支付本金<br><code>EUR3,000,000.00*8.2336=CNY24,700,800.00</code><br>本息费小计<br><code>320,440.17+24,700,800.00=CNY25,021,240.17</code><br> 8月14日支付利息<br><code>EUR8,090,167.55*1.38829%*1/360*8.2000=CNY2,558.29</code><br>支付本金<br><code>EUR8,090,167.55*8.2000=CNY66,339,373.91</code><br>本息费小计<br><code>2,558.29+66,339,373.91=CNY66,341,932.20</code><br>锁汇加融资成本为<br><code>（25,021,240.17+66,341,932.20-85,077,111.34）/85,077,111.34*360/132=28.91216%</code><br>其中:融资费用为1.58829%，汇兑损益27.32387%；汇兑损益,<br><code>-85,077,111.34*27.32387%*92/360=-CNY 5,940,736.27</code><br>因此，在汇率波动剧烈的情形下，可以得出以下结论:</p><ul><li>如果未成功锁汇将造成巨额汇兑亏损CNY 5,940,736.27；</li><li>在巨额的汇兑损益面前，欧元融资利率低的价值几乎可以忽略不计；</li><li>锁汇挂单成本点将融资利率甚至融资手续费考虑进去并不准确。</li></ul><h3 id="五、融美付欧，融资币种的选择"><a href="#五、融美付欧，融资币种的选择" class="headerlink" title="五、融美付欧，融资币种的选择"></a>五、融美付欧，融资币种的选择</h3><table><thead><tr><th>序号</th><th>日期</th><th>事件</th><th>wind美元汇率收盘价</th><th>wind欧&#x2F;美汇率收盘价</th></tr></thead><tbody><tr><td>1</td><td>2020&#x2F;2&#x2F;21</td><td>合同签订</td><td>7.0257</td><td></td></tr><tr><td>2</td><td>2020&#x2F;3&#x2F;3</td><td>开证</td><td>6.9808</td><td></td></tr><tr><td>4</td><td>2020&#x2F;5&#x2F;14</td><td>第2次到单融资付款</td><td>7.0948</td><td>1.0804</td></tr><tr><td>6</td><td>2020&#x2F;8&#x2F;13</td><td>EUR3000000.00+EUR38918.60即期购汇提前还款</td><td>6.9445</td><td></td></tr><tr><td>7</td><td>2020&#x2F;8&#x2F;14</td><td>EUR8090167.55+EUR311.98即期购汇提前还款</td><td>6.9498</td><td></td></tr><tr><td></td><td></td><td></td><td></td><td></td></tr><tr><td>3</td><td>2020&#x2F;4&#x2F;3</td><td>第1次到单融资付款</td><td>7.0903</td><td>1.0799</td></tr><tr><td>8</td><td>2020&#x2F;8&#x2F;14</td><td>EUR11255485.23+EUR20791.38锁汇到期交割</td><td>6.9498</td><td></td></tr><tr><td></td><td></td><td></td><td></td><td></td></tr></tbody></table><p><img src="https://www.z4a.net/images/2023/11/21/111ac1da80517d288f3.png" alt="Wind:欧元汇率走势"></p><h5 id="第1船银行海外代付付款（2020年4月3日）"><a href="#第1船银行海外代付付款（2020年4月3日）" class="headerlink" title="第1船银行海外代付付款（2020年4月3日）"></a>第1船银行海外代付付款（2020年4月3日）</h5><p>假设，欧元付款金额EUR 11,255,485.23 付款日在银行办理押欧付美，美元融资金额<br><code>11,255,485.23*1.0799= $12,154,798.50</code><br>到期日2020年8月14日，期限133天综合费率 <code>libor6+170bps=1.2089%+1.7%=2.9089%</code>（4月3日美元libor6&#x3D;1.2089%）<br>承兑费0.1%，承兑费加代付利息前端收取:<br><code>$12,154,798.50*2.4089%*133/360= $108,172.20</code><br>代付利息0.5%到期支付:<br><code>$12,154,798.50*0.5%*133/360=$22,452.61</code><br>如果不融资4月3日需支付:<br><code>USD12,154,798.50*7.0903=CNY 86,181,167.80</code><br>未锁汇, 4月3日支付费用:<br><code>USD108,172.20*7.0903=CNY766,973.35</code><br>8月14日支付利息:<br><code>$22,452.61*6.9498=CNY156,041.15</code><br>支付本金:<br><code>USD12,154,798.50*6.9498=CNY84,473,418.62</code><br>本息费合计:<br><code>766,973.35+156,041.15+84,473,418.62=CNY 85,396,433.12</code><br>锁汇+融资的成本为:<br><code>（85,396,433.12-86,181,167.80）/86,181,167.80*360/133=-2.4647%</code><br>其中:融资费用为2.9089%，汇兑损益-5.3736%；汇兑损益,<br><code>-86,181,167.80*（-5.3736%）*133/360=CNY1,710,908.76</code></p><p>综合上述，远期汇率下行，汇兑损益收益CNY1,710,908.76</p><h5 id="第2船银行进口押汇付款（2020年5月14日）"><a href="#第2船银行进口押汇付款（2020年5月14日）" class="headerlink" title="第2船银行进口押汇付款（2020年5月14日）"></a>第2船银行进口押汇付款（2020年5月14日）</h5><p>1、欧元付款金额EUR11,090,167.55，付款日2020年5月14日，付款日在银行办理押欧付美，美元融资金额<br><code>11,090,167.55* 1.0804= $11,981,817.02</code><br>到期日2020年8月14日，期限92天综合费率,<code>libor6+170bps=0.6751%+1.7%=2.3751%（5月14日美元libor6=0.6751%）</code><br>承兑费:<br><code>0.1%，$11,981,817.02*0.1%= $ 11,981.82</code><br>押汇利息到期支付:<br><code>$11,981,817.02*2.1751%*92/360=$66,601.99</code><br>如果不融资5月14日需支付人民币:<br><code>USD11,981,817.02*7.0948=CNY 85,008,595.39</code><br>未锁汇, 5月14日日支付费用:<br><code>USD 11,981.82*7.0948=CNY 85,008.62</code><br>8月14日支付利息:<br><code>$66,601.99*6.9498=CNY462,870.51</code><br>支付本金:<br><code>USD11,981,817.02*6.9498=CNY83,271,231.93</code><br>本息费合计:<br><code>85,008.62+462,870.51+ 83,271,231.93 =CNY 83,819,111.06</code><br>锁汇+融资的成本为:<br><code>（83,819,111.06-85,008,595.39）/85,008,595.39*360/92=-5.4753%</code><br>其中:融资费用为2.3751%，汇兑损益-7.8504%；汇兑损益,<br><code>-85,008,595.39*（-7.8504%）*92/360=CNY 1,705,453.78</code></p><p>综合上述，远期汇率下行，汇兑损益收益CNY1,705,453.78。</p><p>进口贸易融资汇率策略:</p><ul><li><p>远期汇率看跌，持有外币融资，最为激进的汇率策略为汇率敞口，较为激进的汇率策略为考虑利息和费用降低成本点锁汇，稳健的汇率策略为仅考虑利息降低成本点锁汇，保守的汇率策略为即期价格锁汇，更为保守的汇率策略为增加成本点锁汇（考虑远期期权费用，上限为人民币基准汇率与欧元贷款利率之间的差额）</p><table><thead><tr><th align="center">远期汇率看跌汇率策略</th><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th align="center">激进+</th><th align="center">激进</th><th align="center">稳健</th><th align="center">保守</th><th align="center">保守+</th></tr></thead><tbody><tr><td align="center">贷款本金</td><td>贷款利息R</td><td>本息合计B     (挂单金额）</td><td>放款日汇率E0</td><td>期权费     （价内）</td><td>融资成本（含承兑和利息）</td><td>融资费用C（含承兑和利息）</td><td>交割日汇率</td><td align="center">成本点（汇率敞口）</td><td align="center">成本点①（利息+承兑费）E1&#x3D;B*E0&#x2F;(B+C)</td><td align="center">成本点②（仅利息）E1&#x3D;B*E0&#x2F;(B+R)</td><td align="center">成本点③</td><td align="center">成本点④（期权费）</td></tr><tr><td align="center">€11,255,485.23</td><td>€   20,791.38</td><td>€   11,276,276.61</td><td>7.7081</td><td>0.2000</td><td>1.51457%</td><td>€    63,096.35</td><td>7.6000</td><td align="center">7.6000</td><td align="center">7.6652</td><td align="center">7.6939</td><td align="center">7.7081</td><td align="center">7.9081</td></tr><tr><td align="center">€11,090,167.55</td><td>€   39,346.28</td><td>€   11,129,513.83</td><td>7.6765</td><td>0.2000</td><td>1.58829%</td><td>€    45,174.29</td><td>7.6000</td><td align="center">7.6000</td><td align="center">7.6455</td><td align="center">7.6495</td><td align="center">7.6765</td><td align="center">7.8765</td></tr></tbody></table></li><li><p>远期汇率看涨，最佳的汇率策略为即期付汇不持有外币融资，如果选择持有，稳健的汇率策略为考虑远期期权费用增加成本点锁汇，即实现即期价格锁汇，激进的汇率策略为即期价格锁汇，更为激进的策略为仅考虑利息降低成本点锁汇，最为激进的汇率策略为考虑利息和费用降低成本点锁汇，距离交割日越近，则选择更高的贴息挂单，如果直到交割月仍未锁汇成功，则可判定为锁汇失败。</p><table><thead><tr><th align="center">远期汇率看涨汇率策略</th><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th align="center">激进++</th><th align="center">激进+</th><th align="center">激进</th><th align="center">稳健</th><th>最佳选择</th></tr></thead><tbody><tr><td align="center">贷款本金</td><td>贷款利息R</td><td>本息合计B     (挂单金额）</td><td>放款日汇率E0</td><td>期权费     （价内）</td><td>融资成本（含承兑和利息）</td><td>融资费用C（含承兑和利息）</td><td>交割日汇率</td><td align="center">成本点①（利息+承兑费）E1&#x3D;B*E0&#x2F;(B+C)</td><td align="center">成本点②（仅利息）E1&#x3D;B*E0&#x2F;(B+R)</td><td align="center">成本点③</td><td align="center">成本点④（期权费）</td><td>不持有欧元负债</td></tr><tr><td align="center">€11,255,485.23</td><td>€   20,791.38</td><td>€   11,276,276.61</td><td>7.7081</td><td>0.2000</td><td>1.51457%</td><td>€    63,096.35</td><td>8.2000</td><td align="center">7.6652</td><td align="center">7.6939</td><td align="center">7.7081</td><td align="center">7.9081</td><td></td></tr><tr><td align="center">€11,090,167.55</td><td>€   39,346.28</td><td>€   11,129,513.83</td><td>7.6765</td><td>0.2000</td><td>1.58829%</td><td>€    45,174.29</td><td>8.2000</td><td align="center">7.6455</td><td align="center">7.6495</td><td align="center">7.6765</td><td align="center">7.8765</td><td></td></tr></tbody></table></li></ul><h5 id="远期锁汇的实例"><a href="#远期锁汇的实例" class="headerlink" title="远期锁汇的实例:"></a>远期锁汇的实例:</h5><p>ELFO2020年10月8日计划付款不大于1,010.89万欧元，计划某银行办理欧元进口押汇，到期日2021年2月3日，期限118天（3M）<br>为计算方便，付款金额取1000万欧元，放款日向前推至2020年8月31日，期限118天，到期日2020年12月27日。3个月某银行美元押汇利率1.9%，3个月欧元押汇利率1.3%，欧元libor3M已参与贷款利率计算。<br>付款日付欧元1000万欧元，<br>8月30日 :<br><code>EUR/CNY=8.1707，USD/CNY=6.8453，EUR/USD=1.1899</code><br>直接付款折人民币:<br><code>EUR10,000,000.000*8.1707= CNY81,707,000.00</code><br>欧元押汇，到期支付本金EUR10,000,000.00,支付利息:<br><code> EUR10,000,000.00*1.3%*118/360= EUR 42,611.11</code><br>美元押汇，到期支付本金USD11,899,000.00,支付利息:<br><code>EUR10,000,000.00*1.1899*1.9%*118/360= USD74,104.33</code><br><img src="https://www.z4a.net/images/2023/11/21/111.jpg" alt="期权产品"><br><img src="https://www.z4a.net/images/2023/11/21/222.jpg" alt="卖出看涨期权"><br>购买3个月买入看涨期权业务（USD&#x2F;CNY）,期权费1096-300&#x3D;796 pips，权利：到期美元汇率高于6.816按照6.816汇率购汇，低于6.816按照不行权即期汇率购汇。</p>]]></content>
    
    
    <categories>
      
      <category>经济</category>
      
      <category>金融</category>
      
    </categories>
    
    
    <tags>
      
      <tag>原创</tag>
      
      <tag>外汇</tag>
      
      <tag>企业融资</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>进口押汇 押欧元还是美元</title>
    <link href="/2023/11/19/%E8%BF%9B%E5%8F%A3%E6%8A%BC%E6%B1%87,%E6%8A%BC%E6%AC%A7%E5%85%83%E8%BF%98%E6%98%AF%E7%BE%8E%E5%85%83/"/>
    <url>/2023/11/19/%E8%BF%9B%E5%8F%A3%E6%8A%BC%E6%B1%87,%E6%8A%BC%E6%AC%A7%E5%85%83%E8%BF%98%E6%98%AF%E7%BE%8E%E5%85%83/</url>
    
    <content type="html"><![CDATA[<p><img src="https://ptpimg.me/lspa93.jpg" alt="押汇的币种如何选?"></p><p>&emsp;&emsp;当外币信用证到单后,如果企业有银行授信会选择办理押汇,是直接办理信用证相同币种的押汇还是办理错币种押汇,下面的公式推导提供了币种选择的理论支持:<br>一、付款币种为欧元</p><p>押欧元金额E0，美元押汇利率r1，欧元押汇利率r2<br>押汇当日EUR&#x2F;USD&#x3D;A0  (欧元兑美元)<br>还款日EUR&#x2F;USD&#x3D;at  USD&#x2F;CNY&#x3D; bt   EUR&#x2F;CNY&#x3D; ct  即at&#x3D; ct&#x2F; bt<br>①押欧元付款，到期日偿还本息人民币合计E0（r2+1）ct<br>②押美元付欧，到期日偿还本息人民币合计E0 A0（r1+1）bt<br>所以，①&lt;②，则押欧元;<br>①&gt;②，则押美元。</p><p>押美元的情况：</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs text">E0（r2+1）ct&gt; E0 A0（r1+1）bt<br><br>ct/ bt&gt; [E0 A0（r1+1）] / [E0（r2+1）]<br><br>ct/ bt &gt; A0（r1+1）/（r2+1）<br></code></pre></td></tr></table></figure><p>其中at&#x3D; ct&#x2F; bt，即<br>at &gt; A0（r1+1）&#x2F;（r2+1）<br>因变量均为正数，<br>所以，当at &gt; A0（r1+1）&#x2F;（r2+1）时，<br>E0（r2+1）ct&gt; E0 A0（r1+1）bt ，即押美元到期支付的人民币少。</p><p>二、付款币种为美元</p><p>押美元金额E0，美元押汇利率r1，欧元押汇利率r2<br>押汇当日EUR&#x2F;USD&#x3D;A0  (欧元兑美元)<br>还款日EUR&#x2F;USD&#x3D;at  USD&#x2F;CNY&#x3D; bt   EUR&#x2F;CNY&#x3D; ct  即at&#x3D; ct&#x2F; bt<br>①押美元付款，到期日偿还本息人民币合计E0（r1+1）bt<br>②押欧付美，到期日偿还本息人民币合计（E0&#x2F; A0）（r2+1） ct所以，①&lt;②，则押美元;<br>①&gt;②，则押欧元。<br>押美元的情况：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs copy">E0（r1+1）bt&lt;（E0/ A0）（r2+1） ct<br><br>&amp;emsp;bt/ct&lt;（r2+1）/ [A0（r1+1）]<br><br>&amp;emsp;ct/ bt &gt; A0（r1+1）/（r2+1）<br></code></pre></td></tr></table></figure><p>其中at&#x3D; ct&#x2F; bt，即<br>at &gt; A0（r1+1）&#x2F;（r2+1）<br>因变量均为正数，<br>所以，当at &gt; A0（r1+1）&#x2F;（r2+1）时，<br>E0（r2+1）ct&gt; E0 A0（r1+1）bt ，即押美元到期支付的人民币少。<br>综合（1）（2），无论付款币种是欧元还是美元，平衡点均为at &#x3D; A0（r1+1）&#x2F;（r2+1）</p><p>&emsp;&emsp;例如,某银行办理押汇时，3个月外币贷款银行报价：美元r1&#x3D;1.72% 欧元 r2&#x3D;1.32%<br>如果取WIND10月16日欧兑美收盘价A0&#x3D;1.1767，则<br> A0（r1+1）&#x2F;（r2+1）<br>&#x3D;1.1767*（1.72%+1）&#x2F;1.32%+1）<br>&#x3D;1.1813<br>&emsp;&emsp;所以，当at&gt;1.1813时，应押美元1.1813-1.1767&#x3D;0.0046，即到期日欧兑美汇率上涨46BPS，押美元财务成本更低，应选择押美元。��美元。</p>]]></content>
    
    
    <categories>
      
      <category>经济</category>
      
      <category>金融</category>
      
    </categories>
    
    
    <tags>
      
      <tag>原创</tag>
      
    </tags>
    
  </entry>
  
  
  
  
</search>
